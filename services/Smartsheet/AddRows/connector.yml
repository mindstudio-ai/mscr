apiVersion: v1
kind: Action
id: add-rows
serviceId: smartsheet
active: false
metadata:
  name: Add Rows
  description: Adds one or more rows to a sheet with specified cell values
  quickHelp: readme.md
configuration:
  - title: Sheet Information
    items:
      - label: Sheet ID
        required: true
        helpText: The ID of the sheet where rows will be added
        variable: sheetId
        type: text
        placeholder: Enter sheet ID...
  - title: Row Data
    items:
      - label: Rows Data
        required: true
        helpText: Array of row objects with cells. Each cell needs columnId and value
        variable: rowsData
        type: text
        textOptions:
          type: multiline
        placeholder: '[{"toBottom":true,"cells":[{"columnId":123456,"value":"Task 1"},{"columnId":789012,"value":"In Progress"}]}]'
  - title: Position Options
    collapsed: true
    items:
      - label: Position Type
        required: false
        helpText: Where to add the rows (applies to first row if not specified per row)
        variable: positionType
        type: select
        defaultValue: toBottom
        selectOptions:
          options:
            - label: To Bottom
              value: toBottom
            - label: To Top
              value: toTop
            - label: Above Row
              value: above
            - label: Below Row
              value: below
      - label: Sibling Row ID
        required: false
        helpText: Required if position is "Above Row" or "Below Row"
        variable: siblingId
        type: text
        placeholder: Enter row ID...
      - label: Access Api Level
        required: false
        helpText: 'Allows COMMENTER access for inputs and return values. For backwards-compatibility, VIEWER is the default. For example, to see whether a user has COMMENTER access for a sheet, use accessApiLevel=1. '
        variable: accessApiLevel
        type: number
        defaultValue: 0
      - label: Allow Partial Success
        required: false
        helpText: When specified with a value of true, enables partial success for this bulk operation. See [Partial Success](https://smartsheet.redoc.ly/#section/Work-at-Scale/Bulk-Operations) for more information.
        variable: allowPartialSuccess
        type: checkbox
        defaultValue: false
      - label: Override Validation
        required: false
        helpText: 'You may use the query string parameter **overrideValidation** with a value of **true** to allow a cell value outside of the validation limits. You must specify **strict** with a value of **false** to '
        variable: overrideValidation
        type: checkbox
        defaultValue: false
  - title: Output
    items:
      - label: Output Variable
        required: true
        helpText: Variable name to store the added rows information
        variable: outputVariable
        type: outputVariableName
